<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <title>Beyond All Random</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Beyond All Random</h1>
      <div class="subtitle">Tweakdefs builder for Beyond All Reason</div>
      <div class="credit">Based on AMBO &amp; MGGW's Random Rarities mod</div>
      <div class="version-line">
        <span class="version-badge" id="version-badge">...</span>
        <a class="changelog-link" id="changelog-link" href="https://github.com/bazilio91/beyond-all-random/releases" target="_blank" rel="noopener">Changelog</a>
      </div>
    </header>

    <section class="how-it-works">
      <h2>How it works</h2>
      <p>This mod randomizes every unit in the game with a rarity tier (Common through Beyond All Reason). Higher rarity units get exponentially stronger stats &mdash; more HP, damage, range, speed &mdash; but also cost more to build. The system has several layers:</p>
      <ul>
        <li><strong>Guaranteed picks</strong> &mdash; Each factory gets at least one high-rarity combat unit so every player has something spicy to build.</li>
        <li><strong>Archetypes</strong> &mdash; Rarity 5+ combat units roll an archetype (Glass Cannon, Tank, Sniper, Brawler) that skews their stat scaling. Turrets get their own set (Fortress, Watchtower, Suppressor).</li>
        <li><strong>Traits</strong> &mdash; Rarity 5+ units with an archetype have a 50% chance to roll a special trait that applies flat bonuses on top of rarity scaling. See the trait table below.</li>
        <li><strong>Cursed units</strong> &mdash; A small percentage of combat units become cursed: weaker stats but much cheaper to build. Interesting strategic trade-offs.</li>
      </ul>

      <h3>Traits</h3>
      <p>Each archetype has its own pool of traits. When a unit qualifies, one trait is randomly selected from its archetype's pool.</p>
      <table class="trait-table">
        <thead><tr><th>Trait</th><th>Archetypes</th><th>Effect</th></tr></thead>
        <tbody>
          <tr><td>Phantom</td><td>Glass Cannon, Sniper, Watchtower</td><td>Cloaking while stationary or slow-moving. Reduced HP.</td></tr>
          <tr><td>Volatile</td><td>Glass Cannon</td><td>+30% damage, &minus;40% HP. Extreme glass cannon.</td></tr>
          <tr><td>Overcharged</td><td>Glass Cannon</td><td>+20% faster reload, +50% energy per shot.</td></tr>
          <tr><td>Juggernaut</td><td>Tank, Fortress</td><td>+60% HP, &minus;30% speed, &minus;25% turn rate (Tank only).</td></tr>
          <tr><td>Regenerator</td><td>Tank</td><td>3&times; idle auto-heal.</td></tr>
          <tr><td>Fortified</td><td>Tank</td><td>+30% HP, +20% slower reload.</td></tr>
          <tr><td>Marksman</td><td>Sniper, Watchtower</td><td>+30% range, +30% better accuracy, &minus;30% AoE.</td></tr>
          <tr><td>Piercing</td><td>Sniper</td><td>+20% damage, &minus;50% AoE. Single-target focus.</td></tr>
          <tr><td>Swift</td><td>Brawler</td><td>+40% speed, +30% acceleration, &minus;30% HP.</td></tr>
          <tr><td>Berserker</td><td>Brawler, Suppressor</td><td>+20&ndash;30% damage, +30% AoE, worse accuracy.</td></tr>
          <tr><td>Siege</td><td>Brawler, Suppressor</td><td>+40% AoE, +15% damage, &minus;15% speed (Brawler) or worse accuracy (Suppressor).</td></tr>
          <tr><td>Shielded</td><td>Fortress</td><td>+40% shield power, +20% shield radius.</td></tr>
          <tr><td>Plague</td><td>Glass Cannon, Brawler</td><td>Weapons set fires on impact (burns wrecks, denies reclaim). +15% AoE, &minus;10% damage.</td></tr>
          <tr><td>Siren</td><td>Fortress, Suppressor</td><td>Extreme knockback on hit &mdash; sends enemies flying. +15% AoE, &minus;30% damage.</td></tr>
          <tr><td>GravWell</td><td>Tank, Watchtower</td><td>Shots pull enemies toward impact point (negative impulse). +40% AoE, &minus;20% damage.</td></tr>
          <tr><td>Bouncer</td><td>Glass Cannon, Brawler</td><td>Massive knockback, sends enemies across the map. &minus;40% damage.</td></tr>
          <tr><td>Drunk</td><td>Sniper, Suppressor</td><td>Projectiles wobble and dance erratically. Much worse accuracy, +30% AoE to compensate.</td></tr>
        </tbody>
      </table>

      <h3>How to use</h3>
      <ol>
        <li>Configure the parameters below and click Generate.</li>
        <li>Copy the output string.</li>
        <li>In the BAR lobby, paste it with: <code>!bset tweakdefs0 &lt;paste&gt;</code></li>
        <li>For faction buffs, use a second slot: <code>!bset tweakdefs1 &lt;paste&gt;</code></li>
      </ol>

      <h3>Faction Buff</h3>
      <p>The faction buff is a separate tweakdefs slot that flat-boosts all units of one faction. Use it for <strong>players vs boosted AI</strong> games &mdash; give the AI faction a stat multiplier to make it a tougher opponent without changing the rarity rolls. You can also use it for asymmetric PvP where one side gets a handicap advantage. Load it in <code>tweakdefs1</code> alongside the rarity mod in <code>tweakdefs0</code>.</p>

      <h3>Renamer widget</h3>
      <p>To see rarity names on units in-game, install the renamer widget from the <a href="https://discord.com/channels/549281623154229250/1468742915315470591/1468742915315470591" target="_blank" rel="noopener">BAR Discord thread</a>. Drop the widget <code>.lua</code> file into your <code>data/LuaUI/Widgets/</code> folder and enable it in-game.</p>
    </section>

    <div class="tabs">
      <button class="tab-btn active" data-panel="panel-rarity">Rarity Mod</button>
      <button class="tab-btn" data-panel="panel-faction">Faction Buff</button>
      <button class="tab-btn" data-panel="panel-welcome">Welcome Message</button>
    </div>

    <div id="panel-rarity" class="panel active">
      <div class="param-row">
        <label><strong>Rarity Chance</strong></label>
        <div class="param-desc">Probability to escalate to the next rarity tier on each roll. At 0.7, each unit has a 70% chance to go from Common to Uncommon, then 70% from Uncommon to Rare, and so on up to 28 tiers. Higher values mean more legendary units but also wilder imbalance.</div>
        <div class="slider-group">
          <input type="range" id="rarity_chance" min="0" max="1" step="0.01" value="0.75">
          <input type="number" id="rarity_chance_num" min="0" max="1" step="0.01" value="0.75">
        </div>
      </div>

      <div class="param-row">
        <label><strong>Curse Chance</strong></label>
        <div class="param-desc">Chance that a combat unit becomes cursed instead of getting a normal rarity roll. Cursed units have reduced HP, damage, range, and speed &mdash; but cost significantly less metal and energy. Set to 0 to disable cursed units entirely.</div>
        <div class="slider-group">
          <input type="range" id="curse_chance" min="0" max="0.5" step="0.01" value="0.2">
          <input type="number" id="curse_chance_num" min="0" max="0.5" step="0.01" value="0.2">
        </div>
      </div>

      <div class="param-row">
        <label><strong>Trait Chance</strong></label>
        <div class="param-desc">Chance that a high-rarity unit with an archetype rolls a special trait on top (e.g. Phantom gives cloaking, Juggernaut gives massive HP). Only applies to units that meet the Min Trait Rarity threshold and already have an archetype.</div>
        <div class="slider-group">
          <input type="range" id="trait_chance" min="0" max="1" step="0.01" value="0.5">
          <input type="number" id="trait_chance_num" min="0" max="1" step="0.01" value="0.5">
        </div>
      </div>

      <div class="param-row">
        <label><strong>Min Factory Rarity</strong></label>
        <div class="param-desc">The minimum rarity floor for guaranteed factory picks. Each factory randomly picks one combat unit and forces it to at least this rarity level. At 7 (Mythical), every player is guaranteed at least one strong unit per factory. Set higher for crazier games.</div>
        <div class="slider-group">
          <input type="range" id="min_factory_rarity" min="1" max="28" step="1" value="7">
          <input type="number" id="min_factory_rarity_num" min="1" max="28" step="1" value="7">
        </div>
      </div>

      <div class="param-row">
        <label><strong>Min Trait Rarity</strong></label>
        <div class="param-desc">Minimum rarity level a unit must reach before it can roll a trait. At 5 (Exotic), any unit with an archetype can get traits. Raise it to keep traits rare and impactful.</div>
        <div class="slider-group">
          <input type="range" id="trait_min_rarity" min="1" max="28" step="1" value="5">
          <input type="number" id="trait_min_rarity_num" min="1" max="28" step="1" value="5">
        </div>
      </div>

      <div class="param-row">
        <label><strong>Per-Faction Rarity Overrides</strong></label>
        <div class="param-desc">Set a rarity floor and ceiling per faction. Units belonging to a faction will have their rarity clamped to this range. Use this to make one faction's units consistently stronger (e.g. set Legion floor to 10 for a tough AI opponent). Leave at 0â€“28 for no override.</div>
        <div class="faction-rarity-grid">
          <div class="faction-rarity-row">
            <span class="faction-label">Armada</span>
            <label>Floor <input type="number" id="arm_floor" min="0" max="28" step="1" value="0"></label>
            <label>Ceiling <input type="number" id="arm_ceil" min="0" max="28" step="1" value="28"></label>
          </div>
          <div class="faction-rarity-row">
            <span class="faction-label">Cortex</span>
            <label>Floor <input type="number" id="cor_floor" min="0" max="28" step="1" value="0"></label>
            <label>Ceiling <input type="number" id="cor_ceil" min="0" max="28" step="1" value="28"></label>
          </div>
          <div class="faction-rarity-row">
            <span class="faction-label">Legion</span>
            <label>Floor <input type="number" id="leg_floor" min="0" max="28" step="1" value="0"></label>
            <label>Ceiling <input type="number" id="leg_ceil" min="0" max="28" step="1" value="28"></label>
          </div>
        </div>
      </div>

      <button class="generate-btn" id="gen-rarity">Generate Rarity Mod</button>
    </div>

    <div id="panel-faction" class="panel">
      <div class="param-row">
        <label><strong>Faction</strong></label>
        <div class="param-desc">Choose which faction's units receive the buff. This applies a flat stat multiplier to all units belonging to the selected faction &mdash; useful for balancing asymmetric games or just having fun.</div>
        <div class="faction-group">
          <button class="faction-btn" data-faction="arm">Armada</button>
          <button class="faction-btn" data-faction="cor">Cortex</button>
          <button class="faction-btn active" data-faction="leg">Legion</button>
        </div>
      </div>

      <div class="param-row">
        <label><strong>Buff Multiplier</strong></label>
        <div class="param-desc">Flat multiplier applied to HP, speed, damage, range, AoE, and shields for all units of the selected faction. Reload time is divided by this value (faster reload). At 1.5x, units are 50% stronger across the board.</div>
        <div class="pct-label" id="pct-label">+50%</div>
        <div class="slider-group">
          <input type="range" id="faction_multiplier" min="1" max="3" step="0.05" value="1.5">
          <input type="number" id="faction_multiplier_num" min="1" max="3" step="0.05" value="1.5">
        </div>
      </div>

      <button class="generate-btn" id="gen-faction">Generate Faction Buff</button>
    </div>

    <div id="panel-welcome" class="panel">
      <p class="param-desc">Generate a <code>!welcome-message</code> command for your BAR lobby. It tells players about the mod and links to the renamer widget. Paste the output into the lobby chat to set the welcome message for all joining players.</p>
      <div class="welcome-preview" id="welcome-preview"></div>
      <button class="generate-btn" id="gen-welcome">Generate Welcome Message</button>
    </div>

    <div class="output-section">
      <div class="output-header">
        <span class="size-counter ok" id="size-counter">0 / 16,384 chars</span>
        <span class="usage-hint" id="usage-hint">!bset tweakdefs0 &lt;paste&gt;</span>
      </div>
      <textarea id="output" readonly></textarea>
      <button class="copy-btn" id="copy-btn">Copy to Clipboard</button>
    </div>
  </div>

  <script>
    var v = new Date().getTime();
    ["js/pipeline.js","js/rarity-template.js","js/faction-template.js","js/app.js"].forEach(function(s) {
      document.write('<script src="' + s + '?v=' + v + '"><\/script>');
    });
  </script>
</body>
</html>
